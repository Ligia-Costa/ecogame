<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoGame - Aventura Corporal</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/posenet"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Estilos adicionais para garantir o layout do jogo real */
        #real-life-mode {
            width: 100%;
        }
        .video-container {
            width: 640px;
            height: 480px;
            max-width: 100%;
            margin: 20px auto;
        }
        .action-indicator {
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
        }
        .timer-container {
            bottom: 20px;
            right: 20px;
        }
    </style>
</head>
<body>

    <div id="real-life-mode" class="screen active">
        <div class="app">
            <header>
                <div class="logo">
                    <div class="logo-icon">üèÉ</div>
                    <h1 class="logo-text">EcoGame: Modo Real</h1>
                </div>
            </header>

            <div class="controls-panel">
                <button id="startBtn" class="btn">‚ñ∂Ô∏è Iniciar Jogo</button>
                <button id="calibrateBtn" class="btn btn-secondary">üìç Calibrar Posi√ß√£o</button>
                <div class="progress-container">
                    <div class="progress-text" id="phase-info">
                        Fase <span id="phaseIdx">1</span> de <span id="phaseTotal">15</span>: <strong id="phaseName">Energias Renov√°veis</strong>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                </div>
                <div id="score-display" class="score-display">
                    Pontos: <span id="score">0</span>
                </div>
            </div>

            <div class="game-container">
                <div class="video-container">
                    <video id="video" autoplay playsinline muted></video>
                    <canvas id="overlay"></canvas>
                    <div class="video-overlay">
                        <div class="action-indicator" id="action-indicator">
                            <div class="action-icon" id="actionIcon">üôå</div>
                            <div class="action-text" id="actionText">Levante os bra√ßos</div>
                        </div>
                        <div class="timer-container">
                             <div class="timer-text" id="timerText">30s</div>
                             <div class="timer-bar">
                                 <div class="timer-progress" id="timerProgress"></div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="questionModal" class="questionModal">
        <div class="modalCard">
            <h3 id="qTitle">Pergunta ‚Äî T√≠tulo da Fase</h3>
            <div class="question-progress">
                <div class="progress-text" id="questionProgressText">
                    Pergunta <span id="questionProgress">1/15</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="questionProgressFill"></div>
                </div>
            </div>
            <p id="qText">Texto da pergunta aparecer√° aqui...</p>
            <div id="choices" class="choices">
                </div>
            <div class="question-points">
                Vale <strong id="questionPoints">20</strong> pontos!
            </div>
        </div>
    </div>

    <div id="final-screen" class="screen">
         <div class="final-container">
            <div class="final-icon">üèÜ</div>
            <h1>Desafio Conclu√≠do!</h1>
            <p id="final-message">Sua dedica√ß√£o √† sustentabilidade √© inspiradora.</p>
            <div class="final-stats">
                <div class="final-stat">
                    <div class="final-stat-value" id="final-score">0</div>
                    <div class="final-stat-label">Pontua√ß√£o Final</div>
                </div>
                <div class="final-stat">
                    <div class="final-stat-value" id="final-time">‚Äî</div>
                    <div class="final-stat-label">Tempo</div>
                </div>
                 <div class="final-stat">
                    <div class="final-stat-value" id="final-correct">‚Äî</div>
                    <div class="final-stat-label">Respostas Corretas</div>
                </div>
            </div>
            <div class="final-buttons">
                <button id="play-again-btn" class="btn">Jogar Novamente</button>
                <button id="change-mode-btn" class="btn btn-secondary">Mudar de Modo</button>
            </div>
        </div>
    </div>

    <div id="mode-selection" class="screen">
        <p>Volte para a <a href="index.html">p√°gina inicial</a> para selecionar outro modo.</p>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Pega o par√¢metro 'avatar' da URL
        const params = new URLSearchParams(window.location.search);
        const avatarId = params.get('avatar');

        if (avatarId) {
            const subjectName = avatarId.replace(/_/g, ' ');
            
            // Simula a sele√ß√£o de avatar para o AppManager
            AppManager.selectedAvatar = {
                subject: subjectName.charAt(0).toUpperCase() + subjectName.slice(1)
            };
            
            // Inicia o jogo diretamente
            AppManager.startRealLifeGame();
        } else {
            // Se nenhum avatar foi passado, redireciona de volta para a escolha
            alert('Nenhum avatar selecionado! Por favor, escolha um para come√ßar.');
            window.location.href = 'avatar.html';
        }
    });
  </script>

    <script src="game.js"></script>

</body>
</html>